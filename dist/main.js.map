{"version":3,"sources":["webpack:///webpack/bootstrap ef78c822f8ee78116646","webpack:///external \"electron\"","webpack:///./src/main/index.js","webpack:///./src/main/trimDesktop.js","webpack:///external \"fs\"","webpack:///./src/main/createCaptureWindow.js"],"names":["app","on","trimDesktop","then","sourceDisplay","trimmedBounds","console","log","displays","screen","getAllDisplays","Promise","resolve","reject","windows","map","display","i","x","y","width","height","bounds","name","win","frame","transparent","alwaysOnTop","loadURL","__dirname","ipcMain","once","e","find","w","webContents","id","sender","profile","forEach","close","regex","matches","match","ext","data","buffer","Buffer","fs","writeFileSync","CaptureWindow","constructor","capture","clippingProfile","_","error","dataURL","nativeImage","createFromDataURL","send","createCaptureWindow"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ef78c822f8ee78116646","module.exports = require(\"electron\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"electron\"\n// module id = 0\n// module chunks = 0 1 2","import { app } from 'electron';\nimport trimDesktop from './trimDesktop';\nimport createCaptureWindow from './createCaptureWindow';\n\napp.on(\"ready\", () => {\n  trimDesktop().then(({ sourceDisplay, trimmedBounds }) => {\n    console.log(sourceDisplay, trimmedBounds);\n  });\n  // createCaptureWindow();\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/main/index.js","import { screen, ipcMain, BrowserWindow } from \"electron\";\nimport fs from 'fs';\n\nfunction trimDesktop() {\n  const displays = screen.getAllDisplays();\n  return new Promise((resolve, reject) => {\n    const windows = displays.map((display, i) => {\n      const { x, y, width, height } = display.bounds;\n      display.name = \"Screen \" + (i + 1);\n      const win = new BrowserWindow({\n        frame: false,\n        transparent: true,\n        alwaysOnTop: true,\n        x, y, width, height,\n      });\n      win.loadURL(`file://${__dirname}/../index.html`);\n      return { win, display };\n    });\n\n    ipcMain.once(\"SEND_BOUNDS\", (e, { trimmedBounds, screen }) => {\n      const sourceDisplay = windows.find(w => w.win.webContents.id === e.sender.id).display;\n      const profile = { sourceDisplay, trimmedBounds };\n      windows.forEach(w => w.win.close());\n      console.log(screen);\n      const regex = /^data:.+\\/(.+);base64,(.*)$/;\n      const matches = screen.match(regex);\n      const ext = matches[1];\n      const data = matches[2];\n      const buffer = new Buffer(data, 'base64');\n      fs.writeFileSync('data.' + ext, buffer);\n      resolve(profile);\n    });\n  });\n}\n\nexport default trimDesktop;\n\n\n\n// WEBPACK FOOTER //\n// ./src/main/trimDesktop.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 17\n// module chunks = 1","import { ipcMain, BrowserWindow, nativeImage } from \"electron\";\n\nclass CaptureWindow {\n\n  constructor() {\n    this.win = new BrowserWindow();\n    this.win.loadURL(`file://${__dirname}/../captureWindow.html`);\n  }\n\n  capture(clippingProfile) {\n    return new Promise((resolve, reject) => {\n      ipcMain.once(\"REPLY_CAPTURE\", (_, { error, dataURL }) => {\n        if (error) {\n          reject(error);\n        } else {\n          // 画像データ（base64文字列）をNativeImage形式へ変換\n          resolve(nativeImage.createFromDataURL(dataURL));\n        }\n      });\n      this.win.webContents.send(\"CAPTURE\", clippingProfile);\n    });\n  }\n\n  close() {\n    this.win.close();\n  }\n}\n\nfunction createCaptureWindow() {\n  return new CaptureWindow();\n}\n\nexport default createCaptureWindow;\n\n\n\n// WEBPACK FOOTER //\n// ./src/main/createCaptureWindow.js"],"sourceRoot":""}